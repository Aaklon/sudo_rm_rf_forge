{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\karan\\\\Downloads\\\\files\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useEffect, useContext } from 'react';\nimport { signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged, GoogleAuthProvider, signInWithPopup } from 'firebase/auth';\nimport { doc, getDoc, setDoc, serverTimestamp } from 'firebase/firestore';\nimport { auth, db } from '../firebase/config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport const useAuth = () => {\n  _s();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  const [currentUser, setCurrentUser] = useState(null);\n  const [userProfile, setUserProfile] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  // Get user profile from Firestore\n  const getUserProfile = async uid => {\n    try {\n      const userDoc = await getDoc(doc(db, 'users', uid));\n      if (userDoc.exists()) {\n        return {\n          id: userDoc.id,\n          ...userDoc.data()\n        };\n      }\n      return null;\n    } catch (error) {\n      console.error('Error fetching user profile:', error);\n      throw error;\n    }\n  };\n\n  // Create user profile in Firestore\n  const createUserProfile = async (uid, data) => {\n    try {\n      const userRef = doc(db, 'users', uid);\n      await setDoc(userRef, {\n        ...data,\n        role: 'student',\n        stats: {\n          xp: 0,\n          level: 1,\n          totalMinutes: 0,\n          totalBookings: 0\n        },\n        achievements: [],\n        createdAt: serverTimestamp(),\n        updatedAt: serverTimestamp()\n      });\n    } catch (error) {\n      console.error('Error creating user profile:', error);\n      throw error;\n    }\n  };\n\n  // Sign up with email and password\n  const signup = async userData => {\n    try {\n      const {\n        email,\n        password,\n        name\n      } = userData;\n      const userCredential = await createUserWithEmailAndPassword(auth, email, password);\n      await createUserProfile(userCredential.user.uid, {\n        name,\n        email,\n        rollNo: userData.rollNo || '',\n        department: userData.department || '',\n        year: userData.year || 1,\n        phone: userData.phone || ''\n      });\n      return userCredential;\n    } catch (error) {\n      throw error;\n    }\n  };\n\n  // Login with email and password\n  const login = async (email, password) => {\n    try {\n      const userCredential = await signInWithEmailAndPassword(auth, email, password);\n      const profile = await getUserProfile(userCredential.user.uid);\n      return {\n        user: userCredential.user,\n        profile\n      };\n    } catch (error) {\n      throw error;\n    }\n  };\n\n  // Login with Google\n  const loginWithGoogle = async () => {\n    try {\n      const provider = new GoogleAuthProvider();\n      const result = await signInWithPopup(auth, provider);\n\n      // Check if user profile exists\n      let profile = await getUserProfile(result.user.uid);\n\n      // Create profile if it doesn't exist\n      if (!profile) {\n        await createUserProfile(result.user.uid, {\n          name: result.user.displayName || 'User',\n          email: result.user.email,\n          rollNo: '',\n          department: '',\n          year: 1,\n          phone: ''\n        });\n        profile = await getUserProfile(result.user.uid);\n      }\n      return {\n        user: result.user,\n        profile\n      };\n    } catch (error) {\n      throw error;\n    }\n  };\n\n  // Logout\n  const logout = async () => {\n    try {\n      await signOut(auth);\n      setUserProfile(null);\n    } catch (error) {\n      throw error;\n    }\n  };\n\n  // Listen to auth state changes\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async user => {\n      setCurrentUser(user);\n      if (user) {\n        try {\n          const profile = await getUserProfile(user.uid);\n          setUserProfile(profile);\n        } catch (error) {\n          console.error('Error fetching user profile:', error);\n        }\n      } else {\n        setUserProfile(null);\n      }\n      setLoading(false);\n    });\n    return unsubscribe;\n  }, []);\n  const value = {\n    currentUser,\n    userProfile,\n    signup,\n    login,\n    loginWithGoogle,\n    logout,\n    getUserProfile\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: !loading && children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 164,\n    columnNumber: 5\n  }, this);\n};\n_s2(AuthProvider, \"bTkDkafiPCgjmH9o6GheLT4aXjI=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","signInWithEmailAndPassword","createUserWithEmailAndPassword","signOut","onAuthStateChanged","GoogleAuthProvider","signInWithPopup","doc","getDoc","setDoc","serverTimestamp","auth","db","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","context","Error","AuthProvider","children","_s2","currentUser","setCurrentUser","userProfile","setUserProfile","loading","setLoading","getUserProfile","uid","userDoc","exists","id","data","error","console","createUserProfile","userRef","role","stats","xp","level","totalMinutes","totalBookings","achievements","createdAt","updatedAt","signup","userData","email","password","name","userCredential","user","rollNo","department","year","phone","login","profile","loginWithGoogle","provider","result","displayName","logout","unsubscribe","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/karan/Downloads/files/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from 'react';\nimport {\n  signInWithEmailAndPassword,\n  createUserWithEmailAndPassword,\n  signOut,\n  onAuthStateChanged,\n  GoogleAuthProvider,\n  signInWithPopup\n} from 'firebase/auth';\nimport { doc, getDoc, setDoc, serverTimestamp } from 'firebase/firestore';\nimport { auth, db } from '../firebase/config';\n\nconst AuthContext = createContext();\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n\nexport const AuthProvider = ({ children }) => {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [userProfile, setUserProfile] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  // Get user profile from Firestore\n  const getUserProfile = async (uid) => {\n    try {\n      const userDoc = await getDoc(doc(db, 'users', uid));\n      if (userDoc.exists()) {\n        return { id: userDoc.id, ...userDoc.data() };\n      }\n      return null;\n    } catch (error) {\n      console.error('Error fetching user profile:', error);\n      throw error;\n    }\n  };\n\n  // Create user profile in Firestore\n  const createUserProfile = async (uid, data) => {\n    try {\n      const userRef = doc(db, 'users', uid);\n      await setDoc(userRef, {\n        ...data,\n        role: 'student',\n        stats: {\n          xp: 0,\n          level: 1,\n          totalMinutes: 0,\n          totalBookings: 0\n        },\n        achievements: [],\n        createdAt: serverTimestamp(),\n        updatedAt: serverTimestamp()\n      });\n    } catch (error) {\n      console.error('Error creating user profile:', error);\n      throw error;\n    }\n  };\n\n  // Sign up with email and password\n  const signup = async (userData) => {\n    try {\n      const { email, password, name } = userData;\n      const userCredential = await createUserWithEmailAndPassword(auth, email, password);\n      await createUserProfile(userCredential.user.uid, {\n        name,\n        email,\n        rollNo: userData.rollNo || '',\n        department: userData.department || '',\n        year: userData.year || 1,\n        phone: userData.phone || ''\n      });\n      return userCredential;\n    } catch (error) {\n      throw error;\n    }\n  };\n\n  // Login with email and password\n  const login = async (email, password) => {\n    try {\n      const userCredential = await signInWithEmailAndPassword(auth, email, password);\n      const profile = await getUserProfile(userCredential.user.uid);\n      return { user: userCredential.user, profile };\n    } catch (error) {\n      throw error;\n    }\n  };\n\n  // Login with Google\n  const loginWithGoogle = async () => {\n    try {\n      const provider = new GoogleAuthProvider();\n      const result = await signInWithPopup(auth, provider);\n      \n      // Check if user profile exists\n      let profile = await getUserProfile(result.user.uid);\n      \n      // Create profile if it doesn't exist\n      if (!profile) {\n        await createUserProfile(result.user.uid, {\n          name: result.user.displayName || 'User',\n          email: result.user.email,\n          rollNo: '',\n          department: '',\n          year: 1,\n          phone: ''\n        });\n        profile = await getUserProfile(result.user.uid);\n      }\n      \n      return { user: result.user, profile };\n    } catch (error) {\n      throw error;\n    }\n  };\n\n  // Logout\n  const logout = async () => {\n    try {\n      await signOut(auth);\n      setUserProfile(null);\n    } catch (error) {\n      throw error;\n    }\n  };\n\n  // Listen to auth state changes\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\n      setCurrentUser(user);\n      if (user) {\n        try {\n          const profile = await getUserProfile(user.uid);\n          setUserProfile(profile);\n        } catch (error) {\n          console.error('Error fetching user profile:', error);\n        }\n      } else {\n        setUserProfile(null);\n      }\n      setLoading(false);\n    });\n\n    return unsubscribe;\n  }, []);\n\n  const value = {\n    currentUser,\n    userProfile,\n    signup,\n    login,\n    loginWithGoogle,\n    logout,\n    getUserProfile\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {!loading && children}\n    </AuthContext.Provider>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}